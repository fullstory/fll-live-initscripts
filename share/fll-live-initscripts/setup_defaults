#!/bin/sh

setup_defaults() {
    FACE=/usr/share/icons/hicolor/scalable/apps/aptosid-fred.svg
    [ -f "${FACE}" ] && cp ${FACE} /etc/skel/.face

    case "${FLL_XSESSION}" in
        lxqt-wayland)
            # Solve a chicken and egg problem: preselect wayland compositor
            # or else startlxqt launches lxqt session prefernces dialog on
            # first login
            mkdir -p /etc/skel/.config/lxqt
            cp /etc/xdg/lxqt/session.conf \
                /etc/skel/.config/lxqt/session.conf
            ;;
        labwc)
            . /etc/default/keyboard
            if [ "${XKBVARIANT}" ]; then
                XKB_DEFAULT_LAYOUT="${XKBLAYOUT}(${XKBVARIANT})"
            else
                XKB_DEFAULT_LAYOUT="${XKBLAYOUT}"
            fi
            cat >> /etc/xdg/labwc/environment <<EOF
XKB_DEFAULT_LAYOUT="${XKB_DEFAULT_LAYOUT}"
EOF
            ;;
        hyprland)
            . /etc/default/keyboard
            cat > /etc/xdg/hypr/kb.conf <<EOF
kb_layout = ${XKBLAYOUT}
kb_variant = ${XKBVARIANT}
kb_model = ${XKBMODEL}
kb_options = ${XKBOPTIONS}
EOF
            # Hyprland doesn't appear to read from /etc/xdg
            mkdir -p /etc/skel/.config
            cp -a /etc/xdg/hypr /etc/skel/.config/
            ;;
    esac
}
